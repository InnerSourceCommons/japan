# チャプター1. チーム間コラボレーションへの強力なアプローチ

近年、オペレーティングシステム、クラウドコンピューティング、JavaScriptフレームワークをはじめとするさまざまなオープンソースソフトウェアの普及に触発され、_インナーソース_ という標語のもと、その強力なオープンソースのプラクティスを模倣して内部のコラボレーションに取り入れようとする企業が増えています。このページでは、インターネット商取引の大手である PayPal の経験から、インナーソースがエンジニア、経営者、マーケティング/PR部門にどのような利益をもたらすかを見ていきます。

インナーソースによるプロジェクトマネジメントの魅力を理解するために、そもそもオープンソースでのソフトウェア開発がなぜここまで成功してきたのか、その要因を考えてみましょう。

* プログラマーは、マネージャーやチームだけでなく、ユーザーやコントリビューターといった幅広い人々と自分の仕事を共有します。ほとんどのオープンソースプロジェクトでは、世界中の誰もが自由にコードをみることができ、コメントを残し、検証することにより新しいスキルを学ぶことができ、また、ニーズに合わせてカスタマイズしたり、改善したコードの変更を提出することができます。
* 該当プロジェクトをもとにした新しいコードリポジトリ(ブランチ)を自由に作成できるため、コードが元々に作られた目的以外の使用にも対応できます。通常、さまざまなブランチを元のマスターブランチに再マージするためのルールと、それを支援する技術があります。
* 地理的に離れた場所にいる人々が、別々の時間に、同じコードで作業したり、同じプロジェクトに異なるコードのファイルを提供することができます。
* コミュニケーションは、口頭で非公式に共有されるのではなく、文書化されて公の場に投稿される傾向があり、それはプロジェクトの履歴を残すことになり、また新しいプロジェクトメンバーに学習の機会を提供することになります。
* 単体テストの作成は、重要なプログラミングタスクになります。 「単体テスト」は、誤った入力を拒否したり、特定の条件下で適切な分岐を行ったりするなど、特定の孤立した動作をチェックする小さなテストです。オープンソースとインナーソースでは、本番稼働中の障害からの保護のために、変更がチェックインされる際、テストが常に実行されます。

単一の組織における見地と制御の範囲内にとどまるという点では、インナーソースは従来のオープンソースとは異なります。プロジェクトの"オープン性"は組織内に限定されますが多くのチームにまたがります。これにより組織は部外者にコードが公開されることを恐れることなく、競争の源泉である企業秘密をコードに埋め込むことができ、同時に組織全体にわたる人々によって提供される多様な視点やクリエイティビティの恩恵を受けることができます。

組織がインナーソースプロジェクトの一部を一般に公開し、それらを効果的にオープンソースに変えることを選択するケースもよくあります。オープンソースの技術と管理手法が社内で使用されていれば、プロジェクトを公の場に移すことは非常に容易になります。

インナーソース戦略を採用する利点は以下の通りです。

* 組織横断的なコードの再利用が飛躍的に進みます。各チームのプログラマーは、他のチームによって開発されたモジュールのコードとアーキテクチャを理解し、コードをコントリビュートすることができます。
* このようなチーム間のコラボレーションが、比較的摩擦の少ないものになります。受け取ったチームがコントリビュートされたコードを書き直すことはほとんどなくなり、上層部における議論も必要なくなります。
* プログラマーは単体テスト、コードカバレッジ、継続的インテグレーションを使い、開発の初期段階でバグを取り除くことを学ぶことができるため、開発はより速くなります。チームメンバー間で交わされるコメントのやり取りには時間がかかりますが、新しいプログラマーがシステムについて早く学ぶことができるようになるため、それ以上の効果があります。
* プログラマーは自分のコードをより良く文書化することを学ぶようになり、それは公式なドキュメント(コード内のコメントや文書)や、非公式なドキュメント(ディスカッションリスト) に対しても効果があります。ドキュメントはプロジェクトの履歴を提供して外部の人間が理解する助けになるため、より多くの人がプロジェクトにコントリビュートできるようになります。

# オープンソースの原則が機能する場

インナーソースがあなたの組織に対して何をもたらすかを考える前に、これらのプラクティスの源泉であるであるフリーでオープンソースのソフトウェアムーブメントがうまく機能している場所と、歴史的にあまり成功していない場所について考察することが重要です。

## Cross-Organizational Collaboration

オープンソースソフトウェアの開発は、チーム、企業、国の境界を越え、世界中の個人がLinuxやApacheのような主要なコンピュータの進歩に協力することを可能にします。Linuxのようなオープンソース・プロジェクトの中心的な貢献者は、今や大企業に勤めているのです。

重要なオープンソースプロジェクトの多くは、独立したプログラマーの発案で始まりましたが、大企業に採用されることがよくあります。また、PayPalをはじめ、そのような企業の中からオープンソースプロジェクトが生まれるケースもある。オープンソースの成功に欠かせないのは、どのような組織であっても、内部の人々が部外者にソフトウェアの開発、テスト、文書化、プロモーションの主要な役割をさせ、すべての貢献者に可能な限り公平な競争の場を提供することです。

## The Difference Between Geographically Dispersed Development and Agile Programming

オープンソースの国境を越えた活動は、アジャイルやスクラムのような一般的な企業の開発アプローチと強く対照的です。後者の開発手法は、一つのオフィスで顔を合わせて仕事をするチームのために設計されたものであることは明らかです。このようなプロジェクトでは、開発者は一緒に仕事をするだけでなく、ソフトウェアユーザーやその他の利害関係者と定期的に会わなければなりません。このような非公式な情報共有により、文書や正式な要件の必要性を減らすことができます。しかし、このような開発手法は、1つの作業現場よりも大きな環境では、あまりうまくいきません。

アジャイルやスクラムが拡張性という代償を払うとすれば、オープンソース開発はスピードという代償を払うことになります。オープンソースプロジェクトは、1つのオフィスで働く専門チームほど速く動くことができません。この代償は、締め切りの厳しい（時には狂おしいほど厳しい）スタートアップ・ベンチャーにとって、明らかに大きな違いとなる。この違いは、[“Value for Software Infrastructure”](#value-for-software-infrastructure)で説明するように、それぞれの開発モデルに適したソフトウェアの種類にも微妙な影響を及ぼします。

進行速度に制限があるにもかかわらず、多くのオープンソースプロジェクトは、厳しい納期を守り、予測可能なリリースを行っています。しかし、予測可能性を高めるために機能を犠牲にすることも少なくありません。特定のリリースで計画されている機能拡張の中には、期限を過ぎないようにするために延期しなければならないものもあるかもしれません。

実際、文献にはこの 2 つを組み合わせたチームが報告されています。<sup>[1](ch01.html#idm45896890983640)</sup> しかし、彼らの異なる要件と前提を理解することは、オープン ソースをよりよく理解することになります。

## 継続的なテストと開発
<!-- [用語] 貢献 or コントリビューション -->
大半のオープンソースプロジェクトでは、寄せられる貢献の一つ一つを厳しく客観的にテストする仕組みを設けています。これにより品質は保たれ、協力者間の信頼も醸成されます。例えば、単体テストや継続的インテグレーションといった標準的な技術が採用されており、それらの技術を正しく使うための規範も徹底されています。オープンソース開発者は品質管理をより科学的にしているのです。

<!-- [用語]リポジトリ or レポジトリ -->
オープンソースにおいてテスト駆動開発は求められないものの、単体テストは非常に重視されています。貢献対象のオープンソースプロジェクトにおける品質保証チームの有無にかかわらず、貢献者は自身の書いたコードを保証するための単体テストも合わせて書くことが求められます。コードを変更するにはテスト実行ツールと所定の手続きが必要であり、変更がリポジトリに取り込まれるためにはテスト結果が潔白であることが求められます。こうすることにより、変更されたコードが意図通りに動くことだけでなく、それ以外のコードに悪影響がないことも確かめられるのです。

コードカバレッジの測定や静的コード解析といった現代的な技術は、オープンソースの世界ではさほど見かけませんが、PayPalでは積極的に使われています。

<!-- [用語]信頼されたコミッター or トラステッドコミッター -->
まとめると、テストと継続的インテグレーションは2つの重要な役割を担っています。まずひとつは勿論のこと、プロダクトが壊れないようにすることです。ですが、それだけではなく、大きな責任を持つに相応しい開発者を見つけるのにも役立つのです。例えば、*信頼されたコミッター* という憧れの称号に相応しい開発者を見つけるには、受け入れられたコミットの数で判断することが通例です。*信頼されたコミッター* は、他の開発者の成果をレビューして採否を判定する役割を持ちます。また、自身はそうしたレビュープロセスを経ることなく変更する権限を持ちます。さらに、品質基準を満たさないコードを提出した伸び盛りの開発者を育てる役割も担います。

## 明文化の重要性

<!-- [訳注]原文ではdocumentationと書かれている。ここでの意味は文書にすることだけでなく、チャットやチケットのコメントも含む。よって明文化と表現した。 -->
さらなるオープンソースの信念は徹底的な明文化です。これは、関係者の地理的な位置とタイムゾーンが多様であることに起因しています。ユーザー向けドキュメントは多くのオープンソースプロジェクトで手薄になりがちなのですが(実はプロプライエタリプロジェクトでも同様に手薄です)、開発者の考える想定、意志決定、実装については積極的に記されます。

こうした実状は「包括的なドキュメントよりも動くソフトウェアを」優先する[アジャイルソフトウェア開発宣言](https://agilemanifesto.org/iso/ja/manifesto.html)とは対照的です。オープンソースコミュニティ(という開発者中心の世界)でも動くソフトウェアが正義とされるものの、実現できた事柄についてはドキュメントに残すことが依然として重視されています。これは一般的なアジャイルに対する特徴として覚えておくべきことです。

オープンソースソフトウェアにおける議論や状況説明といったあらゆるコミュニケーションは明文化されます。例えば、多くのプロジェクトでGitHubに書き込まれるコメントが開発を左右していることでしょう。メーリングリストは議論による意思決定に欠かせないツールとなっているでしょう。「メーリングリストに書かれていることだけが事実だ」という言い回しを聞いたことのある読者も多いのではないでしょうか。
<!-- [訳注] 2022年現在では Gitter や Slack といったツールがメーリングリストに代わって利用される場合も増えているでしょう。 -->

意思決定と実装の詳細を明文化することの価値として、新たに参加しようとする人々のためにプロジェクトの歴史を綴ることが挙げられます。時間をかけて経緯を読み解けば、プロジェクトの文化や学びのある経験を誰でも知ることができるのです。

そして、協働するには同じ言語を用いる必要があることにも注意が必要です。関わる人々が地理的にばらばらであるオープンソースプロジェクトでは、ご存知の通り英語が共通言語となっています(他の言語を用いる重要なプロジェクトもありますが)。読み書きの方が会話よりも民主的なコミュニケーションを促します。なぜなら外国語を流暢に話せるようになるよりも、書けるようになる方が簡単だからです。よって、多くの人々は、結束力は高いものの馴染みのない言語を使うチームよりも、オープンソースプロジェクトに参加できるのです。

## インフラのための価値

<!-- カタカナ英語には長音をつけるか？レイヤー, ユーザー, ハイパーバイザー -->
<!-- OSS or オープンソースソフトウェア -->
オープンソースソフトウェアは低レイヤーで成功してきました。ここで言う低レイヤーとは、OS、ハイパーバイザー、コンパイラーやエディターといった開発者が使うツール、コードの脆弱性を見つけるためのセキュリティツール、その他ユーザーに見えない場所に置かれているものが該当します。

一方、ユーザーインターフェース(UI)はそうではなく、オープンソースとして開発することに根強い反発があることがわかっています。エンドユーザー向けのオープンソースソフトウェアとして広く普及したものはなかなかありません。Mozilla Firefox は珍しい例なのです。

<!-- ToDo:セクションの和名が決まったら修正必要 -->
その理由を知るヒントは、オープンソース開発とアジャイル開発の比較([“The Difference Between Geographically Dispersed Development and Agile Programming”](#the-difference-between))を読み返すとわかるでしょう。アジャイル開発が広く採用されている理由は、開発者がユーザーとの密接な対話を続けられる方法だからです。対話を通じたフィードバックを得てから数日のうちに作業を始められます。一方、ほとんどのオープンソースプロジェクトでは、α版やβリリースといった昔ながらの方法でユーザーの反応を得ています。

<!-- 原著公開から時がたった今では about five years ago ではいつかわからないので2009と明示し、それを示すリンクを追加 -->
単体テストに重点を置いていることも(["継続的なテストと開発"](#継続的なテストと開発))、オープンソースがインフラに向いていることを表しているでしょう。アジャイルの専門家であるマイク・コーンは、2009年にテストピラミッド＊1 という概念を提唱しました。この概念では、UIのテストを最上位、単体テストを最下位とした複数の階層が設けられ、単体テストを最も重視して機能テストとの依存を減らすことが説明されています。

UIを単体テストで確認することは困難であり、できたとしてもその信頼性と価値は低いものになってしまいます。そこで、システム全体の動作と、ユーザーの操作が期待する結果を生むことを確認できる機能テストの出番というわけです。

要するに、オープンソースの品質と信頼を盤石なものとするテストプロセスにおいて、UIのテストは弱いのです。このことも、UIを持つオープンソースソフトウェアが少ない理由かもしれません。

* 訳注
	- ＊1: この文脈で手動テストは含まれないことに注意してください。マイク・コーンは[Succeeding with Agile](https://www.mountaingoatsoftware.com/books/succeeding-with-agile-software-development-using-scrum)または[The Forgotten Layer of the Test Automation Pyramid](https://www.mountaingoatsoftware.com/blog/the-forgotten-layer-of-the-test-automation-pyramid)の中で Test Automation Pyramid と記しています。"自動テストピラミッド" の方が正確な訳ですが、日本では "テストピラミッド" という呼称が普及しています。

## オープンソースに相応しいレベルの発見

オープンソースとフリーソフトウェアは、Microsoft Windows や Oracle Database といったプロプライエタリソフトウェア ＊1と比較されてきました。現在では、SaaS(Software as a Service)という提供モデルがプロプライエタリソフトウェアの開発で一般的になってきました。SaaS では ＊2、どの部分を何の方法で開発するかを決めることになります。InnerSource か、オープンソースか、あるいはアジャイルのような関係者を限定するチーム志向の方法なのかという選択です。この選択には本章がガイドラインとして役立つでしょう。

多くの企業では、いくつかを組み合わせた選択をしています。そうした企業は、ビジネスのコアとなるソフトウェアを SaaS の背後に隠しておく一方で、インフラに相当するソフトウェアを自由に公開・共有しています。また、そのような企業は[クローズドコア](http://radar.oreilly.com/2011/12/could-closed-core-prove-a-more.html)と呼ばれることがあります ＊3。インフラ部分をオープンソースにすることにより、プログラミングに関わる数多の人々が利益を受け、社員の採用と教育が効率的になり、企業は外からの貢献を受け取ることができるようになるのです。

* 訳注
	- ＊1: プロプライエタリ(proprietary)とは、"独占的"、"専売" を意味する形容詞です。プロプライエタリソフトウェアとは、1社が独占的に提供し、ソースコードやその他の中間成果物が非公開であるソフトウェアを主に意味します。本文のように、オープンソースソフトウェアの対義語として使われる場合がほとんどです。
	- ＊2: SaaS に限らず、デスクトップアプリや組込みソフトウェアでも同様の選択をすることがあるでしょう。
	- ＊3: オープン・クローズ戦略の方が日本の企業人にとって馴染みがあるのではないでしょうか。ただし、オープン・クローズ戦略はソフトウェアの開発や提供の方法ではなく知財マネジメントの文脈で語られることに注意が必要です。興味のある読者は[経済産業省発行の2013年版ものづくり白書](https://www.meti.go.jp/report/whitepaper/mono/2013)第3節 その3を参照するとよいでしょう。

# PayPal が InnerSource を採用するまで

PayPal が InnerSource を採用するまでの過程には企業としての意志決定の積み重ねがあり、歴史的で大規模なものです。InnerSource の採用は、それまでに何度かあった企業変革と同様に、ツールと企業文化の戦略的変更として進められました。

PayPal が InnerSource を採用する以前に行われた変革とその結果は次の通りです。

* 開発速度を向上させる技術の調査と適用 (例：多くのプロジェクトが Java から JavaScript または Node.js に移行した)
* 採用した新技術に関係するオープンソースコミュニティと開発モデルへの興味が醸成された
* 社内と社外どちらの協働でも GitHub が使われるようになった
* 品質に高い関心が払われるようになった

つまり、PayPal では InnerSource を採用する前からオープンソースにゆかりのある技術を部分的に採用していたということです。また、一部の社内用コードをオープンソース化することにも取り組みました。逆の順序、すなわち社内という限られた空間でオープンソース由来の方法を実践してからオープンソースソフトウェアを公開するという道を辿る企業もいることでしょう。ただ、その方が一般的に難しいと考えられています。どちらの順序にしても、オープンソースのツールと、オープンソースソフトウェアの協働的な開発プロセスを促進する GitHub のようなツールを熟知していることが重要です。

<!-- section=>節, chapter=>章 -->
PayPal における様々な変化は同時に発生し、明らかに相互に影響しています。以降の節ではそれらを紐解き、各変化を個別に説明してゆきます。

## 末端から始める

PayPalのインナーソースは、米国外で働く地域セールスエンジニアから始まりました。彼らは、各地域の利用者の好みに合わせたり、地域向けのプロモーションに役立てるためにユーザー向けのコードを修正しました。しかし、そうしたプログラマーたちが行った変更が、すぐにコアチームに受け入れられるわけではありませんでした。バイスプレジデントなどが介入してマージを求め、そのあとで反対するコアエンジニアがマージ前に変更を書き戻すこともありました。

その一方で、他のチームの開発者との間で飛び交う緊急のEメールのやり取りで、不十分なドキュメントをカバーしていました。これらのメールには重要な情報が含まれていましたが、その他の多くの開発者が目にすることはありませんでした。多くの地域組織では、そうしたメッセージをそれぞれ独自のWikiにカット＆ペーストする試みを始める始末でした。

多くの地域のエンジニアがサンノゼの本社に飛んできて、1ヶ月間コアチームから直接教えを受けました。しかし、信頼できるコミッターを育てる手法としては、知識を十分に広めたとはいえず、投資に見合うものではありませんでした。ドキュメントの作成も進みませんでした。エンジニアたちが母国に帰国した後は、遠方のため、文書による問い合わせを通じて、コアメンターシップを探すことを余儀なくされました。

その結果、インナーソースのほうが良い方法かもしれないと考えられました。各チームはインナーソースによってプロジェクトが本当に効率化することに気づきました。そして、コア側の信頼できるコミッターも、そのプロセスがはるかに優れていることに気づきました。リモートエンジニアは GitHub からコードサンプルをプルすることができました。

コアチームは、より上手に各地域のコラボレーターたちと連携する方法を学べただけでなく、地域のコントリビューターたちへの指導を通じて、モジュール性と理解しやすさを高めるためにコアコードのどこをリファクタリングすればよいかのヒントを得るようになりました。また、異なる地域で行われた作業のパターンに気づくことができたため、経験豊富な地域のエンジニアを、他の地域の仲間のメンターに採用することができました。

## よりスピーディな開発プロセス

PayPalの黎明期は比較的モノリシックなC++プラットフォームでスタートしました。その後、レガシーな要素はC++が残りながらも、新規開発についてはJava Springを使って、よりモジュール化された方法で行われるようになりました。その移行後も、開発者のジェフ・ハレルが言うには、各製品に多くの「部族内知識」が埋め込まれていました。そのため、小さな変更であっても導入には数週間が必要で、新入社員には6週間のトレーニング期間が必要だったのです。

3年前、PayPalはNode.jsを採用し、大きな変化を遂げました。PayPal のNode.js 開発者であるプーニマ・ベンカタクリシュナン氏によると、Node.jsのプラットフォームはまずプロトタイピングのために使用されました。その結果に満足した開発者たちは、本番環境に導入したいと考えました。まずはJava SpringプラットフォームとNode.jsで同じ機能を並行して開発する実験を試みました。開発時間・コード行数・開発に必要なエンジニアの数などを基準に、二つのプラットフォームを比較したのです。Node.jsは明らかに勝っていました。

PayPalがNode.jsを採用するという発表は、多くのプログラマ、特にC++からJavaへの移行が長くて大変だったことを記憶しているプログラマを心配させました。しかし、PayPalは、Node.jsへの移行がまったく違うものであることを示しました。PayPalは、移行トレーニングにわずか2日間のスケジュールを組みました。ハレル氏によると、参加者はすぐに、自分たちが新しく、活気があり、エキサイティングな世界に入ったことを実感したといいます。さらに、JavaScriptの分野のリーダーであるダグラス・クロックフォード氏をトレーニングのスタッフとして迎えられたことも幸運でした。(クロックフォード氏は、非常に人気の高い書籍[JavaScript: The Good Parts](http://shop.oreilly.com/product/9780596517748.do)_の著者であり、オライリーの[JavaScript Master Classビデオ](http://shop.oreilly.com/product/9780596809614.do)の制作者でもあります)。

現在、Paypalの新機能開発チームの大半はJavaを利用していますが、その一方で、Node.jsチームが開拓したインナーソースのプラクティスを採用しているチームが存在します。

## Engaging with Open Source

Node.jsに移行するためのトレーニングは、多くの教材がオンラインで利用できたことと、前回のJavaへの移行に比べてカスタマイズの必要性が少なかったことから、短時間で簡単に行うことができました。基本的には、2日間のトレーニングで、スタッフが自ら学習プロセスを継続できるように準備するのに十分だった。

ハレル氏によると、PayPalのプログラマーに、基本的な情報はPayPal社内のメーリングリストで上級プログラマーに尋ねるのではなく、StackOverflowなどのサイトで検索すればよい（あるいは単に検索エンジンを使えばよい）ことを伝えるのに時間がかかったそうです。しかし、やがて情報への問い合わせは、オープンソースコミュニティへの全面的な関与へと広がっていきました。

多くの企業は、オープンソースの技術を採用することで、単に高品質で無料であることに魅力を感じ、その技術を生み出すコミュニティへの継続的な参加につながることに気づきます。

これは、PayPalがNode.jsを採用したときに起こったことです。今では、Node.jsはかなり成熟した技術になっています。Node.jsはピークを過ぎ、JavaScriptプログラマは代替品を探していると指摘するコメンテータもいるほどです。(後述するように、オープンソース技術の変化のスピードは、どの技術を採用するかの意思決定を変化させます)。しかし、PayPalは、Node.jsコミュニティのために有用なツールを開発する余地が十分にある、初期の段階で参入してきました。PayPal は、Node.js 財団と ECMAScript Technical Committee 39 の非常にアクティブなメンバになりました。

プログラマの自己啓発と新入社員の即時生産性という2つの目標を促進するために、PayPalはJavaScriptとNode.jsへの移行時に他の人気のあるオープンソースツールを積極的に導入しました。例えば、テストにはSelenium、継続的インテグレーションにはJenkins、JavaのテストにはTestNG、JUnit、Mockitoといったツールが広く使われている。その過程で、PayPalは、[Nemo](https://github.com/paypal/nemo) (元々はMatt Edelmanが書いた)、 [SeLion](http://selion.io) および [Illuminator](https://github.com/paypal/Illuminator) など、オープンソースのコンポーネントと互換性のある多くのツールを開発しオープンソースを提供しました。

PayPal は Node.js を開発初期に採用し、特定のツールが不足していたため、同社は Node.js アーキテクチャを制御するフレームワークである [Kraken] (http://krakenjs.com/) を開発しました。Harrellによると、チームは、Harrellが他のPayPalのコードで見た「部族的」知識から解放され、一般的な価値があることを確認するために、フレームワークをオープンソースとして開発することに決めたそうです。Krakenは、おそらく彼らの最も成功したオープンソースプロジェクトになりました。

Venkatakrishnanは、この時PayPalに入ったオープンソースの実践を次のように挙げている。

* 高い品質基準を設定すること。コードをコミットする前に、コードカバレッジテストを少なくとも90%以上実行しなければならない。誰かがコミットを送ると、それが自動的な再構築の引き金となり、マージするのに十分な品質であることが確認されます。
* リポジトリにあるすべてのコードに対して、ドキュメントを要求すること。
* すべてのディスカッションをGitHub上で行い、コラボレーションを可能にし、チーム外の人からのインプットを促進する。社内プロジェクト用のプライベートなGitHubリポジトリと、オープンソースのコード用のパブリックなGitHubリポジトリがあります。
* 誰もがイノベーションを起こせると感じられるようにすること。
* すべての専門知識が1つのチームから得られる必要はないことをエンジニアに教えること。オープンソースソフトウェアでは、世界中のどこからでも助けを得ることができるのです。また、公開されているオープンソースプロジェクトに貢献することで、会社の知名度が上がり、コミュニティに対するコミットメントを示すことができます。
* チーム内で行われた仕事に対する誇りを育み、カンファレンスでそれについて話したり、PayPalのエンジニアリングブログに書いたりするよう奨励する。

ハレルは、ソフトウェアスタックの上位に行けば行くほど、技術の変動が激しいと指摘する。ソフトウェア開発における変化は、特にオープンソース技術では継続的である。そこでPayPalは、チームが常に自分たちの技術を評価することを推奨している。各開発者には継続的な学習が期待される。

必然的に、代替ツールの評価は、チームごとにツールの多様性をもたらす。開発者のマット・エデルマンは、この現象はオープンソースに特によく見られると指摘しています。なぜなら、開発者はUnixの家長であるケン・トンプソンが提案した、「多くの小さなプログラムが一緒に動く」という線に沿ってツールを開発するのが好きだからです。

そのため、ReactやAngularなど、さまざまな最先端技術が使用されています。プログラマーは、ツールを推奨する前にトイプロジェクトで試し、選択肢を慎重に比較した上で選択することが期待されています。

オープンソースのアーキテクチャは、機能を拡張する技術の代替実装を可能にするプラグインを備えていることがよくあります。Edelmanによると、PayPalはKrakenのプラグインの一部を内部で（InnerSourceモデルを通じて）開発し、その他をオープンソースとして開発しているそうです。

## GitHub　コラボレーション

ある企業がモダンなコード開発において非常に特殊で重要なポジションを築いています。それはGitHubです。もともとは開発を容易にするためのバージョン管理ソフトウェアであるGitを用いたSaaSプラットフォームでしたが、現在では開発者が唯一無二と感じる機能を備え、非常に洗練されたコラボレーションプラットフォームへと進化しました。詳細については次の2点が参考になります [Git for Teams](http://shop.oreilly.com/product/0636920034520.do)と [Collaborating with Git video](http://shop.oreilly.com/product/0636920034872.do)。

PayPalでは、KrakenのようにオープンソースプロジェクトのコードをGitHubに置くだけでなく、社内にGitHub Enterpriseを設置し、GitHubのパブリックユーザーと同じように社内で共同作業ができるようにしています。コードレビューやコミット、テストはオープンソースと同じように行われますが、社内リポジトリの上で行われています。最も重要なことは、PayPalの各チームメンバーが他の社内のプログラマーからも新しいコードを受け取るという事が習慣化されているという事です。

エデルマンによると、GitHubとInnerSourceに移行する前は、PayPalのプログラマーは他のチームに対しては小さなバグ修正を提供するくらいしかできなかったと言います。もし彼らがより大きなコードを提供をする場合、受け取ったチームはコードを精査し、場合によってはゼロからコードを書いた場合と比べて変わらないような事がたまに起きていました。チーム間でのコードのやりとりについては、高いレベルの管理者が関与しなければならないこともしばしばでした。

しかし最近では、新機能に対して大幅に書き換える事なくチェックインできるようになりました。その理由の1つは、ドキュメントに対する新しい考えです。インナーソースのプロジェクトは、システムを深く理解する少数の特権的なプログラマーだけでなく、より多くの社内プログラマの上に成り立っていなければならないとエデルマンは強調しています。誰もがプロジェクトを学習し、大きな変更を提案することができるのです。

また、ドキュメント（コードとGitHubのコメントの両方）によって、開発者はアーキテクチャ変更の必要性を理解するようになります。仮にあなたももし４回に分けて様々な人に、なぜそれが複雑になっていて直感的ではなのかを説明しなければならないとしたら、考え方が変わるでしょう。

また、プログラマーが国を超えて力を発揮することで、知的な成長や仕事のやりがいを感じるようになります。プログラマーは、コードの設計についてより包括的に考えるようになり、同時にコードレビューやテスト、ドキュメントの書き方などの新しいスキルも身につけることができます。インナーソースは "全員のパフォーマンスを底上げする"と、エデルマンは言っています。

エデルマンは、コアインフラストラクチャ内のモジュールで見つかったあるセキュリティ関連のバグについて言及しています。ある機能が、仕様書（RFC）に正確に沿っていなかったのです。当初、インフラ・チームの外から彼らに対して修正するように圧力がかかり、多くの電子メールが飛び交いました。しかし、ある外部のメンバー（セキュリティは専門外）がRFCを見て、自分でも修正できることに気づいたのです。そして、その修正案を提出したところ、コア・インフラ・チームがすぐにそれをマージしてくれました。この逸話は、プログラマーが自発的に行動することの重要性と、きちんと文書化された標準に従うことの価値という、2つの原則を示しています。

## 品質の向上

同時期に、PayPalはプラットフォームの大部分をNode.jsに移行し、オープンソースのプラクティスを採用しつつ、品質向上への取り組みを開始しました。品質保証のリーダーであるダグ・シモンズによると、PayPalのこの目標に向けたステップは以下の通りでした。

* より多くの単体テスト
* 継続的なインテグレーション
* コードレビュー
* より多くのコードカバレッジレポート
* 静的解析

すべての会話が公の場で行われる必要はありませんが、GitHub のコメントプロセスはいくつかの点で品質を向上させています。信頼できるコミッターは、自分のコードをリポジトリに受け入れたいと願っている新人プログラマーのメンターとしても効果的に機能します。投稿者と信頼できるコミッターの間で交わされるコメントのやりとりは、投稿者にとっても他のプログラマーにとっても、そのやりとりを見て学ぶことができる教育的なものです。

## 文化の変化

インナーソースの採用という大きな企業の動きには、従業員の不安と期待への慎重な対応が求められます。PayPalはこの変化を支援するために、外部のオープンソース開発専門家を雇いました。

多くの企業のオブザーバーは、従業員が他のチームにコードを提供する事への自信を与えることが、最も重要な文化的変化だと同意しているようです。これは、完全なドキュメンテーションと優れたメンタリングで達成できますが、エデルマンは、スタッフの習慣を、バグに苦情を言うものから修正を行うものへと変えなければならないと指摘しています。
<!-- 従業員、社員、スタッフ、開発者 -->

ハレルは、チームメンバーを説得して、チーム外のPayPalプログラマーがコントリビューションできるようにしたことを覚えています。チームメンバーは、外部のコードのチェックにばかり時間をとられ、自分たちがコードをかけなくなるのではないかと、よく反対していました。別の企業の調査では、新しいコントリビューションが自分のメンテナンスの手間を増やすことになるのではないかと、プログラマーが心配していました。<sup>[2](ch01.html#idm45896890913528)</sup><sup>,</sup> <sup>[3](ch01.html#idm45896890901048)</sup>
<!-- Herrell　ハレル　ハーレル -->

しかし、厳密なテストとビルドプロセスでコントリビューションの質を確保していたため、これらの欠点は予想より少なかったことはご承知のとおりです。いずれにしても、コントリビューションのチェックには高いスキルが必要だと、ハレルは述べています。そして、コントリビューションは、チームが作成したコードの価値を高めていきました。

エデルマンは、「モジュールの作者には、品質と一貫性の基準を維持しつつ、コミュニティからのフィードバックや変更に対してオープンであることで、ソフトウェアの価値を高めていくことが期待される」と述べています。彼によると、開発者は、テストを書いたりコードレビューをしたりすることへの不満から、それを主張するようになったそうです。
<!-- Edelman エデルマン 書いています/述べています　キュレーションするで通じるか確認？ -->

品質面では、プログラマーがインナーソースのバグレポートを提出すると、まずはモジュールの担当者に送られます。このプログラマーは、そのバグレポートを影響を受けるコードのコントリビューターに渡すことができます。

モジュラーアーキテクチャと明確なAPI定義は、チーム外からのコントリビューションを促進するために不可欠だということが、多くのプログラミングチームにより確認されています。

インナーソースの開発プラクティスは、本質的にオープンソースの開発プラクティスと同じなので、社内で開発されたプロジェクトをオープンソース化するのは非常に簡単です。技術的にチームがすべきことは、コードをパブリックリポジトリに移動して、社内メンバーからのバグレポートやコードコントリビューションに対して行ってきたことを、社外で行うだけです。

ただし、いくつか法的な壁が立ちはだかる可能性があります。プログラマーが外部のコードをプロジェクトに組み込んだ場合を例に挙げます。このとき、法務部門はすべてのライセンスを調査して、彼らがコードをオープン化する権利を持つか、それらのコードのライセンスが組み込んだコードのライセンスと互換性があるかを確認しなければなりません。また、ブランドレビューが必要な場合もあります。PayPalでは、法務チームがオープンソース専門家と相談し、必要な手順をウェブベースで行えるようにしました。

現代のプログラマは、変化が成長につながることを学びます。新しい技術やツールはさておき、文化を変えることで、機敏に行動し、最新のスキルを身につけ続けることができるのです。インナーソースは、これらすべての成果への第一歩です。

<sup>[1](ch01.html#idm45896890983640-marker)</sup> Stol, KJ, P. Avgeriou et al. [“Key Factors for Adopting Inner Source.”](http://www.brian-fitzgerald.com/wp-content/uploads/2014/05/TOSEM-2014-stol.pdf) _ACM Transactions on Software Engineering Methodology (TOSEM)_ (2014): Vol 23, No 2.

<sup>[2](ch01.html#idm45896890913528-marker)</sup> Ibid.

<sup>[3](ch01.html#idm45896890901048-marker)</sup> Stol, KJ, AB Muhammad, et al. [“A comparative study of challenges in integrating Open Source Software and Inner Source Software.”](http://www.cs.rug.nl/paris/papers/IST11.pdf) _Information and Software Technology_ 53 (2011): 1319–1336\.

# 著者紹介

**アンディ・オラム** は、オライリー・メディアの編集者です。1992年から同社に勤務しており、現在はオープンソース技術とソフトウェアエンジニアリングを専門としています。オライリーでの彼の著作には、米国で初めて出版されたLinuxの書籍や、2001年に出版された _Peer-to-Peer_ 、2007年のベストセラー _Beautiful Code_ などがあります。
